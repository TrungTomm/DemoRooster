var t,e;t=void 0,e=function(){var t=[],e=function(t,e){for(var r=t.scene,i=r.input.cameras.getCamerasBelowPointer(e),o=r.input.manager,s=[t],a=0,u=i.length;a<u;a++)if(o.hitTest(e,s,i[a],n),n.length>0)return n.length=0,!0;return n.length=0,!1},n=[],r=function(t){return void 0!==t.displayWidth?t.displayWidth:t.width},i=function(t){return void 0!==t.displayHeight?t.displayHeight:t.height};const o=Phaser.Geom.Rectangle,s=Phaser.Math.Vector2,a=Phaser.Math.RotateAround;var u=void 0,c=function(t,e,n){return void 0===e?e=new s:!0===e&&(void 0===g&&(g=new s),e=g),t.getTopLeft?t.getTopLeft(e):(e.x=t.x-r(t)*t.originX,e.y=t.y-i(t)*t.originY,y(t,e,n))},d=function(t,e,n){return void 0===e?e=new s:!0===e&&(void 0===g&&(g=new s),e=g),t.getTopRight?t.getTopRight(e):(e.x=t.x-r(t)*t.originX+r(t),e.y=t.y-i(t)*t.originY,y(t,e,n))},f=function(t,e,n){return void 0===e?e=new s:!0===e&&(void 0===g&&(g=new s),e=g),t.getBottomLeft?t.getBottomLeft(e):(e.x=t.x-r(t)*t.originX,e.y=t.y-i(t)*t.originY+i(t),y(t,e,n))},h=function(t,e,n){return void 0===e?e=new s:!0===e&&(void 0===g&&(g=new s),e=g),t.getBottomRight?t.getBottomRight(e):(e.x=t.x-r(t)*t.originX+r(t),e.y=t.y-i(t)*t.originY+i(t),y(t,e,n))},g=void 0,y=function(t,e,n){return void 0===n&&(n=!1),0!==t.rotation&&a(e,t.x,t.y,t.rotation),n&&t.parentContainer&&t.parentContainer.getBoundsTransformMatrix().transformPoint(e.x,e.y,e),e},l=function(t,e,n,r,i){if(!t)return!1;if(r&&!r(t,e,n))return!1;var s=function(t,e){if(void 0===e?e=new o:!0===e&&(void 0===u&&(u=new o),e=u),t.getBounds)return t.getBounds(e);var n,r,i,s,a,g,y,l;if(t.parentContainer){var p=t.parentContainer.getBoundsTransformMatrix();c(t,e),p.transformPoint(e.x,e.y,e),n=e.x,r=e.y,d(t,e),p.transformPoint(e.x,e.y,e),i=e.x,s=e.y,f(t,e),p.transformPoint(e.x,e.y,e),a=e.x,g=e.y,h(t,e),p.transformPoint(e.x,e.y,e),y=e.x,l=e.y}else c(t,e),n=e.x,r=e.y,d(t,e),i=e.x,s=e.y,f(t,e),a=e.x,g=e.y,h(t,e),y=e.x,l=e.y;return e.x=Math.min(n,i,a,y),e.y=Math.min(r,s,g,l),e.width=Math.max(n,i,a,y)-e.x,e.height=Math.max(r,s,g,l)-e.y,e}(t,!0);return!(!s.contains(e,n)||i&&!i(t,e,n))},p=function(t,e,n){var r=t.camera;return r?(void 0===n?n={}:!0===n&&(n=v),r===e?(n.x=t.worldX,n.y=t.worldY):r.getWorldPoint(t.x,t.y,n),n):null},v={};const x=Phaser.Scene;class m{constructor(t){t instanceof x&&(t=t.game),this.ticker=t.loop,this.topObjects={}}destroy(){this.ticker=void 0,this.topObjects=void 0}isAtTop(t,e){var n,r=this.ticker.frame,i=this.topObjects[t];return i?(n=i.tick<r||i.tick===r&&void 0!==e&&i.key===e)&&(i.tick=r,i.key=e):(this.topObjects[t]={tick:r,key:e},n=!0),n}clear(){return function(t){if("object"!=typeof t||null===t)return t;if(Array.isArray(t))t.length=0;else for(var e in t)delete t[e]}(this.topObjects),this}}class w extends Phaser.Plugins.BasePlugin{constructor(t){super(t)}start(){this.game.events.on("destroy",this.destroy,this),this.touchGroup=new m(this.game)}destroy(){this.touchGroup.destroy(),super.destroy()}isAtTop(t,e){return this.touchGroup.isAtTop(t,e)}}var P={hitTest:function(e,n,r,i,o){var s,a,u,c=e.input,d=c.manager;void 0===n&&(n=c.topOnly),void 0===o&&(o=[]),void 0===r&&(r=c._list),void 0===i&&(i=d.pointers,s=d.pointersTotal),void 0===s&&(s=i.length);for(var f=0;f<s;f++){a=i[f];for(var h=0,g=(u=c.cameras.getCamerasBelowPointer(a)).length;h<g;h++)o.push(...d.hitTest(a,r,u[h],t))}return c.sortGameObjects(o),n&&o.length&&o.splice(1),t.length=0,o},isPointerInHitArea:function(t,n,r,i,o){if(n)return!(r&&!r(t,n)||!e(t,n)||i&&!i(t,n));void 0===o&&(o=!1);for(var s=t.scene.input.manager,a=s.pointersTotal,u=s.pointers,c=0;c<a;c++)if(n=u[c],(!r||r(t,n))&&e(t,n)&&(!i||i(t,n)))return!o||n;return!1},isPointerInBounds:function(t,e,n,r){var i,o=t.scene.sys.cameras.main,s=0===t.scrollFactorX&&0===t.scrollFactorY;if(e)return s?l(t,e.x,e.y,n,r):!!(i=p(e,o,!0))&&l(t,i.x,i.y,n,r);for(var a=t.scene.input.manager,u=a.pointersTotal,c=a.pointers,d=0;d<u;d++)if(e=c[d],s){if(l(t,e.x,e.y,n,r))return!0}else{if(!(i=p(e,o,!0)))continue;if(l(t,i.x,i.y,n,r))return!0}return!1}};return Object.assign(w.prototype,P),w},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).rextouchhelperplugin=e();
